<!DOCTYPE HTML>
<html>
    <head>
        <title>WebSockets</title>
        <script type="text/javascript" src="gateway.js"></script>
    </head>
    <body>
        <input type="text" id="addedAccessPoint"> access point to add
        <input type="button" id="addAccessPoint" value="add access point" />
        <br/>

        <b id="currentAccessPoint"></b>
        <input type="button" id="back" value="back" />
        <input type="button" id="forward" value="forward" />
        <br/>

        <input type="file" id="file" />
        <br/>

        <input type="button" id="setConnection" value="set connection" />
        <br/>

        <input type="button" id="addSendArray" value="add to send array" />
        <br/>

        <input type="text" id="readBufferSize"> read max size(bytes)
        <input type="button" id="readButton" value="send read" />
        <br/>

        <br/>
        <input type="button" id="sendFile" value="send array" />

        <div id="output"></div>
        <script type="text/javascript">
            window.onload = function() {
                var output = document.getElementById('output');

                var currentAccessPoint = document.getElementById('currentAccessPoint');
                currentAccessPoint.innerText = gateway.getCurrentAccessPoint();

                var addedAccessPoint = document.getElementById('addedAccessPoint');
                var addAccessPointButton = document.getElementById('addAccessPoint');
                addAccessPointButton.onclick = function() {
                    gateway.addAccessPoint(addedAccessPoint.value);
                }

                var backButton = document.getElementById('back');
                backButton.onclick = function() {
                    gateway.changeAccessPoint('back');
                    currentAccessPoint.innerText = gateway.getCurrentAccessPoint();
                }

                var forwardButton = document.getElementById('forward');
                forwardButton.onclick = function() {
                    gateway.changeAccessPoint('forward');
                    currentAccessPoint.innerText = gateway.getCurrentAccessPoint();
                }

                var setConnectionButton = document.getElementById('setConnection');
                setConnectionButton.onclick = function() {
                    var sendFile = document.getElementById('file').files[0];
                    var reader = new FileReader();
                    reader.onload = function(event) {
                        gateway.connectAccessPoint(output, event.target.result);
                    }
                    reader.readAsText(sendFile);
                }

                var addSendArray = document.getElementById('addSendArray');
                addSendArray.onclick = function() {
                    var sendFile = document.getElementById('file').files[0];
                    var reader = new FileReader();
                    reader.onload = function(event) {
                        gateway.addSendArray(event.target.result);
                    }
                    reader.readAsText(sendFile);
                }

                var readButton = document.getElementById('readButton');
                readButton.onclick = function() {
                    var readBufferSize = parseInt(document.getElementById('readBufferSize').value);
                    gateway.read(readBufferSize);
                }

                var sendButton = document.getElementById('sendFile');
                sendButton.onclick = function() {
                    gateway.write();
                }
            }
        </script>
    </body>
</html>